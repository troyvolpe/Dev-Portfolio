# Nginx configuration for Troy's Portfolio with visitor logging
# Place this file in /etc/nginx/sites-available/troyvolpe.com
# and create symlink in /etc/nginx/sites-enabled/

server {\n    listen 80;\n    listen [::]:80;\n    server_name troyvolpe.com www.troyvolpe.com;\n\n    # Redirect HTTP to HTTPS if SSL is configured\n    # return 301 https://$server_name$request_uri;\n\n    # If no SSL, serve directly:\n    root /var/www/Dev-Portfolio;\n    index index.html;\n\n    # Main site files\n    location / {\n        try_files $uri $uri/ /index.html;\n        add_header Cache-Control \"no-cache, no-store, must-revalidate\";\n        add_header Pragma \"no-cache\";\n        add_header Expires \"0\";\n    }\n\n    # Proxy visitor logger API\n    location /api/log-visit {\n        proxy_pass http://127.0.0.1:3001/log-visit;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_cache_bypass $http_upgrade;\n    }\n\n    # Static file optimization\n    location ~* \\.(js|css|png|jpg|jpeg|gif|ico|svg)$ {\n        expires 1y;\n        add_header Cache-Control \"public, immutable\";\n    }\n}\n\n# HTTPS configuration (if SSL is set up)\n# server {\n#     listen 443 ssl http2;\n#     listen [::]:443 ssl http2;\n#     server_name troyvolpe.com www.troyvolpe.com;\n#\n#     # SSL Certificate paths (update these)\n#     ssl_certificate /path/to/your/cert.pem;\n#     ssl_certificate_key /path/to/your/private.key;\n#\n#     root /var/www/Dev-Portfolio;\n#     index index.html;\n#\n#     location / {\n#         try_files $uri $uri/ /index.html;\n#     }\n#\n#     location /api/log-visit {\n#         proxy_pass http://127.0.0.1:3001/log-visit;\n#         proxy_http_version 1.1;\n#         proxy_set_header Upgrade $http_upgrade;\n#         proxy_set_header Connection 'upgrade';\n#         proxy_set_header Host $host;\n#         proxy_set_header X-Real-IP $remote_addr;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header X-Forwarded-Proto $scheme;\n#         proxy_cache_bypass $http_upgrade;\n#     }\n# }